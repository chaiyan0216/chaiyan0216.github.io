<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="serialVersionUID 和 Runtime" /><meta property="og:locale" content="en" /><meta name="description" content="关于 serialVersionUID、Runtime、ProcessBuilder 的三篇教程，serialVersionUID 和后两者没啥关系，不想开新帖了，就写在一起。 [What is the serialVersionUID? Baeldung](https://www.baeldung.com/java-serial-version-uid) Java.lang.Runtime class in Java - GeeksforGeeks [Guide to java.lang.ProcessBuilder API Baeldung](https://www.baeldung.com/java-lang-processbuilder-api) Serial Version UID Simply put, we use the serialVersionUID attribute to remember versions of a Serializable class to verify that a loaded class and the serialized object are compatible. 简单来说：serialVersionUID 是用来校验反序列化的类和内存里已加载的类是否兼容的。 具体过程： 1) 类进行序列化时 serialVersionUID 会被写到文件中，如果没有这个值，虚拟机也会自动生成一个。 If serialVersionUID is not provided in a Serializable class, the JVM will generate one automatically. However, it is good practice to provide the serialVersionUID value and update it after changes to the class so that we can have control over the serialization/deserialization process. 2) 一个类经过序列化后，它会以一个文件的方式存在于磁盘或者网络中。经过一段时间之前的代码发生了更新，同一个类增加或者删除了某个属性。这时候如果开发人员认为跟更改之前不兼容了，那么就需要更新 serialVersionUID；如果认为依然兼容之前的类，那么开发人员可以保持 serialVersionUID 不变。 3) 类文件反序列化时，虚拟机检查文件中的 serialVersionUID，判断它是否与当前类的 serialVersionUID 一致，如果一致就说明序列化类的版本与当前类版本是一样的，可以反序列化成功，否则失败。 生成方式： 默认的1L，比如：private static final long serialVersionUID = 1L; 根据类名、接口名、成员方法及属性等来生成一个64位的哈希字段，比如：private static final long serialVersionUID = xxxxL; Runtime Every Java application has a single instance of class Runtime that allows the application to interface with the environment in which the application is running. The current runtime can be obtained from the getRuntime method. Runtime 是一个封装了 JVM 进程的类。每一个 Java 应用实际上都是启动了一个 JVM 进程，每一个 JVM 进程就是一个 Runtime 实例。Runtime 实例可以用来与所在运行环境进行交互，譬如：获取计算机资源、执行 shell 命令等。下边是教程中的几个例子： 1 2 3 4 5 6 7 8 9 10 11 // 获取当前空闲内存 public class GFG { public static void main(String[] args) { // get the current runtime assosiated with this process Runtime run = Runtime.getRuntime(); // print the current free memory for this runtime System.out.println(&quot;&quot; + run.freeMemory()); } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // linux 下打开 chrome public class GFG { public static void main(String[] args) { try { // create a process and execute google-chrome Process process = Runtime.getRuntime().exec(&quot;google-chrome&quot;); System.out.println(&quot;Google Chrome successfully started&quot;); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // 程序退出时打印新的 Message public class GFG { // a class that extends thread that is to be called when program is exiting static class Message extends Thread { public void run() { System.out.println(&quot;Program exiting&quot;); } } public static void main(String[] args) { try { // register Message as shutdown hook Runtime.getRuntime().addShutdownHook(new Message()); // cause thread to sleep for 3 seconds System.out.println(&quot;Waiting for 5 seconds...&quot;); Thread.sleep(5000); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // 执行命令 public class GFG { public static void main(String[] args) { try { String[] cmd = new String[2]; cmd[0] = &quot;atom&quot;; cmd[1] = &quot;File.java&quot;; // create a process and execute cmdArray Process process = Runtime.getRuntime().exec(cmd); // print another message System.out.println(&quot;File.java opening in atom&quot;); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // 在特定环境变量和目录下，执行命令 public class GFG { public static void main(String[] args) { try { String[] cmd = new String[2]; cmd[0] = &quot;atom&quot;; cmd[1] = &quot;File.java&quot;; // create a file with the working directory we wish File dir = new File(&quot;/home/saket/Desktop&quot;); // create a process and execute cmdArray Process process = Runtime.getRuntime().exec(cmd, null, dir); System.out.println(&quot;File.java opening.&quot;); } catch (Exception e) { e.printStackTrace(); } } } ProcessBuilder The ProcessBuilder class provides methods for creating and configuring operating system processes. ProcessBuilder 用于创建操作系统进程，提供了启动和管理进程（也就是应用程序）的方法。 Each ProcessBuilder instance allows us to manage a collection of process attributes. We can then start a new Process with those given attributes. ProcessBuilder 实例用来管理进程属性集，通过 start 方法使用这些属性去创建 Process，start 方法可以从同一 ProcessBuilder 实例重复调用，以利用相同的或相关的属性创建新的子进程。 Runtime 的 exec 方法就是通过调用 ProcessBuilder API 实现的。 一些 API： 1 ProcessBuilder(String... command) To create a new process builder with the specified operating system program and arguments, we can use this convenient constructor. 构造函数 1 directory(File directory) We can override the default working directory of the current process by calling the directory method and passing a File object. By default, the current working directory is set to the value returned by the user.dir system property. 工作目录，默认是 user.dir 1 environment() If we want to get the current environment variables, we can simply call the environment method. It returns us a copy of the current process environment using System.getenv() but as a Map. 获取环境变量 1 inheritIO() If we want to specify that the source and destination for our subprocess standard I/O should be the same as that of the current Java process, we can use the inheritIO method. 子进程使用当前 Java 进程相同的 IO 1 redirectInput(File file), redirectOutput(File file), redirectError(File file) When we want to redirect the process builder’s standard input, output and error destination to a file, we have these three similar redirect methods at our disposal. 重定向输入、输出、错误的重定向 1 start() Last but not least, to start a new process with what we’ve configured, we simply call start(). 启动进程 一个例子： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 @Test public void givenProcessBuilder_whenModifyWorkingDir_thenSuccess() throws IOException, InterruptedException { ProcessBuilder processBuilder = new ProcessBuilder(&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;ls&quot;); processBuilder.directory(new File(&quot;src&quot;)); Process process = processBuilder.start(); List&lt;String&gt; results = readOutput(process.getInputStream()); assertThat(&quot;Results should not be empty&quot;, results, is(not(empty()))); assertThat(&quot;Results should contain directory listing: &quot;, results, contains(&quot;main&quot;, &quot;test&quot;)); int exitCode = process.waitFor(); assertEquals(&quot;No errors should be detected&quot;, 0, exitCode); }" /><meta property="og:description" content="关于 serialVersionUID、Runtime、ProcessBuilder 的三篇教程，serialVersionUID 和后两者没啥关系，不想开新帖了，就写在一起。 [What is the serialVersionUID? Baeldung](https://www.baeldung.com/java-serial-version-uid) Java.lang.Runtime class in Java - GeeksforGeeks [Guide to java.lang.ProcessBuilder API Baeldung](https://www.baeldung.com/java-lang-processbuilder-api) Serial Version UID Simply put, we use the serialVersionUID attribute to remember versions of a Serializable class to verify that a loaded class and the serialized object are compatible. 简单来说：serialVersionUID 是用来校验反序列化的类和内存里已加载的类是否兼容的。 具体过程： 1) 类进行序列化时 serialVersionUID 会被写到文件中，如果没有这个值，虚拟机也会自动生成一个。 If serialVersionUID is not provided in a Serializable class, the JVM will generate one automatically. However, it is good practice to provide the serialVersionUID value and update it after changes to the class so that we can have control over the serialization/deserialization process. 2) 一个类经过序列化后，它会以一个文件的方式存在于磁盘或者网络中。经过一段时间之前的代码发生了更新，同一个类增加或者删除了某个属性。这时候如果开发人员认为跟更改之前不兼容了，那么就需要更新 serialVersionUID；如果认为依然兼容之前的类，那么开发人员可以保持 serialVersionUID 不变。 3) 类文件反序列化时，虚拟机检查文件中的 serialVersionUID，判断它是否与当前类的 serialVersionUID 一致，如果一致就说明序列化类的版本与当前类版本是一样的，可以反序列化成功，否则失败。 生成方式： 默认的1L，比如：private static final long serialVersionUID = 1L; 根据类名、接口名、成员方法及属性等来生成一个64位的哈希字段，比如：private static final long serialVersionUID = xxxxL; Runtime Every Java application has a single instance of class Runtime that allows the application to interface with the environment in which the application is running. The current runtime can be obtained from the getRuntime method. Runtime 是一个封装了 JVM 进程的类。每一个 Java 应用实际上都是启动了一个 JVM 进程，每一个 JVM 进程就是一个 Runtime 实例。Runtime 实例可以用来与所在运行环境进行交互，譬如：获取计算机资源、执行 shell 命令等。下边是教程中的几个例子： 1 2 3 4 5 6 7 8 9 10 11 // 获取当前空闲内存 public class GFG { public static void main(String[] args) { // get the current runtime assosiated with this process Runtime run = Runtime.getRuntime(); // print the current free memory for this runtime System.out.println(&quot;&quot; + run.freeMemory()); } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // linux 下打开 chrome public class GFG { public static void main(String[] args) { try { // create a process and execute google-chrome Process process = Runtime.getRuntime().exec(&quot;google-chrome&quot;); System.out.println(&quot;Google Chrome successfully started&quot;); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // 程序退出时打印新的 Message public class GFG { // a class that extends thread that is to be called when program is exiting static class Message extends Thread { public void run() { System.out.println(&quot;Program exiting&quot;); } } public static void main(String[] args) { try { // register Message as shutdown hook Runtime.getRuntime().addShutdownHook(new Message()); // cause thread to sleep for 3 seconds System.out.println(&quot;Waiting for 5 seconds...&quot;); Thread.sleep(5000); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // 执行命令 public class GFG { public static void main(String[] args) { try { String[] cmd = new String[2]; cmd[0] = &quot;atom&quot;; cmd[1] = &quot;File.java&quot;; // create a process and execute cmdArray Process process = Runtime.getRuntime().exec(cmd); // print another message System.out.println(&quot;File.java opening in atom&quot;); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // 在特定环境变量和目录下，执行命令 public class GFG { public static void main(String[] args) { try { String[] cmd = new String[2]; cmd[0] = &quot;atom&quot;; cmd[1] = &quot;File.java&quot;; // create a file with the working directory we wish File dir = new File(&quot;/home/saket/Desktop&quot;); // create a process and execute cmdArray Process process = Runtime.getRuntime().exec(cmd, null, dir); System.out.println(&quot;File.java opening.&quot;); } catch (Exception e) { e.printStackTrace(); } } } ProcessBuilder The ProcessBuilder class provides methods for creating and configuring operating system processes. ProcessBuilder 用于创建操作系统进程，提供了启动和管理进程（也就是应用程序）的方法。 Each ProcessBuilder instance allows us to manage a collection of process attributes. We can then start a new Process with those given attributes. ProcessBuilder 实例用来管理进程属性集，通过 start 方法使用这些属性去创建 Process，start 方法可以从同一 ProcessBuilder 实例重复调用，以利用相同的或相关的属性创建新的子进程。 Runtime 的 exec 方法就是通过调用 ProcessBuilder API 实现的。 一些 API： 1 ProcessBuilder(String... command) To create a new process builder with the specified operating system program and arguments, we can use this convenient constructor. 构造函数 1 directory(File directory) We can override the default working directory of the current process by calling the directory method and passing a File object. By default, the current working directory is set to the value returned by the user.dir system property. 工作目录，默认是 user.dir 1 environment() If we want to get the current environment variables, we can simply call the environment method. It returns us a copy of the current process environment using System.getenv() but as a Map. 获取环境变量 1 inheritIO() If we want to specify that the source and destination for our subprocess standard I/O should be the same as that of the current Java process, we can use the inheritIO method. 子进程使用当前 Java 进程相同的 IO 1 redirectInput(File file), redirectOutput(File file), redirectError(File file) When we want to redirect the process builder’s standard input, output and error destination to a file, we have these three similar redirect methods at our disposal. 重定向输入、输出、错误的重定向 1 start() Last but not least, to start a new process with what we’ve configured, we simply call start(). 启动进程 一个例子： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 @Test public void givenProcessBuilder_whenModifyWorkingDir_thenSuccess() throws IOException, InterruptedException { ProcessBuilder processBuilder = new ProcessBuilder(&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;ls&quot;); processBuilder.directory(new File(&quot;src&quot;)); Process process = processBuilder.start(); List&lt;String&gt; results = readOutput(process.getInputStream()); assertThat(&quot;Results should not be empty&quot;, results, is(not(empty()))); assertThat(&quot;Results should contain directory listing: &quot;, results, contains(&quot;main&quot;, &quot;test&quot;)); int exitCode = process.waitFor(); assertEquals(&quot;No errors should be detected&quot;, 0, exitCode); }" /><link rel="canonical" href="/language/java/posts/serialversionuid_runtime_process/" /><meta property="og:url" content="/language/java/posts/serialversionuid_runtime_process/" /><meta property="og:site_name" content="Chai Yan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-02T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="serialVersionUID 和 Runtime" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-08-02T00:00:00+08:00","datePublished":"2021-08-02T00:00:00+08:00","description":"关于 serialVersionUID、Runtime、ProcessBuilder 的三篇教程，serialVersionUID 和后两者没啥关系，不想开新帖了，就写在一起。 [What is the serialVersionUID? Baeldung](https://www.baeldung.com/java-serial-version-uid) Java.lang.Runtime class in Java - GeeksforGeeks [Guide to java.lang.ProcessBuilder API Baeldung](https://www.baeldung.com/java-lang-processbuilder-api) Serial Version UID Simply put, we use the serialVersionUID attribute to remember versions of a Serializable class to verify that a loaded class and the serialized object are compatible. 简单来说：serialVersionUID 是用来校验反序列化的类和内存里已加载的类是否兼容的。 具体过程： 1) 类进行序列化时 serialVersionUID 会被写到文件中，如果没有这个值，虚拟机也会自动生成一个。 If serialVersionUID is not provided in a Serializable class, the JVM will generate one automatically. However, it is good practice to provide the serialVersionUID value and update it after changes to the class so that we can have control over the serialization/deserialization process. 2) 一个类经过序列化后，它会以一个文件的方式存在于磁盘或者网络中。经过一段时间之前的代码发生了更新，同一个类增加或者删除了某个属性。这时候如果开发人员认为跟更改之前不兼容了，那么就需要更新 serialVersionUID；如果认为依然兼容之前的类，那么开发人员可以保持 serialVersionUID 不变。 3) 类文件反序列化时，虚拟机检查文件中的 serialVersionUID，判断它是否与当前类的 serialVersionUID 一致，如果一致就说明序列化类的版本与当前类版本是一样的，可以反序列化成功，否则失败。 生成方式： 默认的1L，比如：private static final long serialVersionUID = 1L; 根据类名、接口名、成员方法及属性等来生成一个64位的哈希字段，比如：private static final long serialVersionUID = xxxxL; Runtime Every Java application has a single instance of class Runtime that allows the application to interface with the environment in which the application is running. The current runtime can be obtained from the getRuntime method. Runtime 是一个封装了 JVM 进程的类。每一个 Java 应用实际上都是启动了一个 JVM 进程，每一个 JVM 进程就是一个 Runtime 实例。Runtime 实例可以用来与所在运行环境进行交互，譬如：获取计算机资源、执行 shell 命令等。下边是教程中的几个例子： 1 2 3 4 5 6 7 8 9 10 11 // 获取当前空闲内存 public class GFG { public static void main(String[] args) { // get the current runtime assosiated with this process Runtime run = Runtime.getRuntime(); // print the current free memory for this runtime System.out.println(&quot;&quot; + run.freeMemory()); } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // linux 下打开 chrome public class GFG { public static void main(String[] args) { try { // create a process and execute google-chrome Process process = Runtime.getRuntime().exec(&quot;google-chrome&quot;); System.out.println(&quot;Google Chrome successfully started&quot;); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // 程序退出时打印新的 Message public class GFG { // a class that extends thread that is to be called when program is exiting static class Message extends Thread { public void run() { System.out.println(&quot;Program exiting&quot;); } } public static void main(String[] args) { try { // register Message as shutdown hook Runtime.getRuntime().addShutdownHook(new Message()); // cause thread to sleep for 3 seconds System.out.println(&quot;Waiting for 5 seconds...&quot;); Thread.sleep(5000); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // 执行命令 public class GFG { public static void main(String[] args) { try { String[] cmd = new String[2]; cmd[0] = &quot;atom&quot;; cmd[1] = &quot;File.java&quot;; // create a process and execute cmdArray Process process = Runtime.getRuntime().exec(cmd); // print another message System.out.println(&quot;File.java opening in atom&quot;); } catch (Exception e) { e.printStackTrace(); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // 在特定环境变量和目录下，执行命令 public class GFG { public static void main(String[] args) { try { String[] cmd = new String[2]; cmd[0] = &quot;atom&quot;; cmd[1] = &quot;File.java&quot;; // create a file with the working directory we wish File dir = new File(&quot;/home/saket/Desktop&quot;); // create a process and execute cmdArray Process process = Runtime.getRuntime().exec(cmd, null, dir); System.out.println(&quot;File.java opening.&quot;); } catch (Exception e) { e.printStackTrace(); } } } ProcessBuilder The ProcessBuilder class provides methods for creating and configuring operating system processes. ProcessBuilder 用于创建操作系统进程，提供了启动和管理进程（也就是应用程序）的方法。 Each ProcessBuilder instance allows us to manage a collection of process attributes. We can then start a new Process with those given attributes. ProcessBuilder 实例用来管理进程属性集，通过 start 方法使用这些属性去创建 Process，start 方法可以从同一 ProcessBuilder 实例重复调用，以利用相同的或相关的属性创建新的子进程。 Runtime 的 exec 方法就是通过调用 ProcessBuilder API 实现的。 一些 API： 1 ProcessBuilder(String... command) To create a new process builder with the specified operating system program and arguments, we can use this convenient constructor. 构造函数 1 directory(File directory) We can override the default working directory of the current process by calling the directory method and passing a File object. By default, the current working directory is set to the value returned by the user.dir system property. 工作目录，默认是 user.dir 1 environment() If we want to get the current environment variables, we can simply call the environment method. It returns us a copy of the current process environment using System.getenv() but as a Map. 获取环境变量 1 inheritIO() If we want to specify that the source and destination for our subprocess standard I/O should be the same as that of the current Java process, we can use the inheritIO method. 子进程使用当前 Java 进程相同的 IO 1 redirectInput(File file), redirectOutput(File file), redirectError(File file) When we want to redirect the process builder’s standard input, output and error destination to a file, we have these three similar redirect methods at our disposal. 重定向输入、输出、错误的重定向 1 start() Last but not least, to start a new process with what we’ve configured, we simply call start(). 启动进程 一个例子： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 @Test public void givenProcessBuilder_whenModifyWorkingDir_thenSuccess() throws IOException, InterruptedException { ProcessBuilder processBuilder = new ProcessBuilder(&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;ls&quot;); processBuilder.directory(new File(&quot;src&quot;)); Process process = processBuilder.start(); List&lt;String&gt; results = readOutput(process.getInputStream()); assertThat(&quot;Results should not be empty&quot;, results, is(not(empty()))); assertThat(&quot;Results should contain directory listing: &quot;, results, contains(&quot;main&quot;, &quot;test&quot;)); int exitCode = process.waitFor(); assertEquals(&quot;No errors should be detected&quot;, 0, exitCode); }","headline":"serialVersionUID 和 Runtime","mainEntityOfPage":{"@type":"WebPage","@id":"/language/java/posts/serialversionuid_runtime_process/"},"url":"/language/java/posts/serialversionuid_runtime_process/"}</script><title>serialVersionUID 和 Runtime | Chai Yan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Chai Yan"><meta name="application-name" content="Chai Yan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Chai Yan</a></div><div class="site-subtitle font-italic">Personal technical blog, recording interesting things.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/chaiyan0216" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['chaiyan2046','163.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>serialVersionUID 和 Runtime</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>serialVersionUID 和 Runtime</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1627833600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 2, 2021 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/chaiyao0216">Chai Yan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1443 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>关于 serialVersionUID、Runtime、ProcessBuilder 的三篇教程，serialVersionUID 和后两者没啥关系，不想开新帖了，就写在一起。</p><div class="table-wrapper"><table><tbody><tr><td>[What is the serialVersionUID?<td>Baeldung](https://www.baeldung.com/java-serial-version-uid)</table></div><p><a href="https://www.geeksforgeeks.org/java-lang-runtime-class-in-java/">Java.lang.Runtime class in Java - GeeksforGeeks</a></p><div class="table-wrapper"><table><tbody><tr><td>[Guide to java.lang.ProcessBuilder API<td>Baeldung](https://www.baeldung.com/java-lang-processbuilder-api)</table></div><h3 id="serial-version-uid"><span class="mr-2">Serial Version UID</span><a href="#serial-version-uid" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>Simply put, we use the <strong>serialVersionUID</strong> attribute to remember versions of a <strong>Serializable</strong> class to verify that <strong>a loaded class and the serialized object are compatible</strong>.</p></blockquote><p>简单来说：serialVersionUID 是用来校验<strong>反序列化的类</strong>和<strong>内存里已加载的类</strong>是否兼容的。</p><p>具体过程：</p><p>1) 类进行序列化时 serialVersionUID 会被写到文件中，如果没有这个值，虚拟机也会自动生成一个。</p><blockquote><p>If <em>serialVersionUID</em> is not provided in a <em>Serializable</em> class, <strong>the JVM will generate one automatically</strong>. However, it is good practice to provide the serialVersionUID value and <strong>update it after changes to the class so that we can have control over the serialization/deserialization process</strong>.</p></blockquote><p>2) 一个类经过序列化后，它会以一个文件的方式存在于磁盘或者网络中。经过一段时间之前的代码发生了更新，同一个类增加或者删除了某个属性。这时候如果开发人员认为跟更改之前不兼容了，那么就需要更新 serialVersionUID；如果认为依然兼容之前的类，那么开发人员可以保持 serialVersionUID 不变。</p><p>3) 类文件反序列化时，虚拟机检查文件中的 serialVersionUID，判断它是否与当前类的 serialVersionUID 一致，如果一致就说明序列化类的版本与当前类版本是一样的，可以反序列化成功，否则失败。</p><p>生成方式：</p><ol><li><p>默认的1L，比如：private static final long serialVersionUID = 1L;</p><li><p>根据类名、接口名、成员方法及属性等来生成一个64位的哈希字段，比如：private static final long serialVersionUID = xxxxL;</p></ol><h3 id="runtime"><span class="mr-2">Runtime</span><a href="#runtime" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>Every Java application has a single instance of class Runtime that allows the application to interface with the environment in which the application is running. The current runtime can be obtained from the <strong>getRuntime</strong> method.</p></blockquote><p>Runtime 是一个封装了 JVM 进程的类。每一个 Java 应用实际上都是启动了一个 JVM 进程，每一个 JVM 进程就是一个 Runtime 实例。Runtime 实例可以用来与所在运行环境进行交互，譬如：获取计算机资源、执行 shell 命令等。下边是教程中的几个例子：</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">// 获取当前空闲内存</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GFG</span>
<span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="c1">// get the current runtime assosiated with this process</span>
		<span class="nc">Runtime</span> <span class="n">run</span> <span class="o">=</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">();</span>
		<span class="c1">// print the current free memory for this runtime</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">""</span> <span class="o">+</span> <span class="n">run</span><span class="o">.</span><span class="na">freeMemory</span><span class="o">());</span>
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1">// linux 下打开 chrome</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GFG</span>
<span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="k">try</span>
		<span class="o">{</span>
			<span class="c1">// create a process and execute google-chrome</span>
			<span class="nc">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="s">"google-chrome"</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Google Chrome successfully started"</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c1">// 程序退出时打印新的 Message</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GFG</span>
<span class="o">{</span>
	<span class="c1">// a class that extends thread that is to be called when program is exiting</span>
	<span class="kd">static</span> <span class="kd">class</span> <span class="nc">Message</span> <span class="kd">extends</span> <span class="nc">Thread</span>
	<span class="o">{</span>
		<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span>
		<span class="o">{</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Program exiting"</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="k">try</span>
		<span class="o">{</span>
			<span class="c1">// register Message as shutdown hook</span>
			<span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">addShutdownHook</span><span class="o">(</span><span class="k">new</span> <span class="nc">Message</span><span class="o">());</span>
			
			<span class="c1">// cause thread to sleep for 3 seconds</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Waiting for 5 seconds..."</span><span class="o">);</span>
			<span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">5000</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="c1">// 执行命令</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GFG</span>
<span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="k">try</span>
		<span class="o">{</span>
			<span class="nc">String</span><span class="o">[]</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
			<span class="n">cmd</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="s">"atom"</span><span class="o">;</span>
			<span class="n">cmd</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="s">"File.java"</span><span class="o">;</span>
			<span class="c1">// create a process and execute cmdArray</span>
			<span class="nc">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="n">cmd</span><span class="o">);</span>

			<span class="c1">// print another message</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"File.java opening in atom"</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="c1">// 在特定环境变量和目录下，执行命令</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GFG</span>
<span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>
	<span class="o">{</span>
		<span class="k">try</span>
		<span class="o">{</span>
			<span class="nc">String</span><span class="o">[]</span> <span class="n">cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
			<span class="n">cmd</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="s">"atom"</span><span class="o">;</span>
			<span class="n">cmd</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="s">"File.java"</span><span class="o">;</span>
			<span class="c1">// create a file with the working directory we wish</span>
			<span class="nc">File</span> <span class="n">dir</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"/home/saket/Desktop"</span><span class="o">);</span>
			<span class="c1">// create a process and execute cmdArray</span>
			<span class="nc">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">exec</span><span class="o">(</span><span class="n">cmd</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">dir</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"File.java opening."</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span>
		<span class="o">{</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="processbuilder"><span class="mr-2">ProcessBuilder</span><a href="#processbuilder" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>The <em>ProcessBuilder</em> class provides methods for creating and configuring operating system processes.</p></blockquote><p>ProcessBuilder 用于创建操作系统进程，提供了启动和管理进程（也就是应用程序）的方法。</p><blockquote><p><strong>Each ProcessBuilder instance allows us to manage a collection of process attributes</strong>. We can then start a new <em>Process</em> with those given attributes.</p></blockquote><p>ProcessBuilder 实例用来管理进程属性集，通过 start 方法使用这些属性去创建 Process，start 方法可以从同一 ProcessBuilder 实例重复调用，以利用相同的或相关的属性创建新的子进程。</p><p>Runtime 的 exec 方法就是通过调用 ProcessBuilder API 实现的。</p><p>一些 API：</p><ul><li><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">ProcessBuilder</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">command</span><span class="o">)</span>
</pre></table></code></div></div><blockquote><p>To create a new process builder with the specified operating system program and arguments, we can use this convenient constructor.</p></blockquote><p>构造函数</p><li><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">directory</span><span class="o">(</span><span class="nc">File</span> <span class="n">directory</span><span class="o">)</span>
</pre></table></code></div></div><blockquote><p>We can override the default working directory of the current process by calling the <em>directory</em> method and passing a <em>File</em> object. <strong>By default, the current working directory is set to the value returned by the user.dir system property</strong>.</p></blockquote><p>工作目录，默认是 user.dir</p><li><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">environment</span><span class="o">()</span>
</pre></table></code></div></div><blockquote><p>If we want to get the current environment variables, we can simply call the <em>environment</em> method. It returns us a copy of the current process environment using <em>System.getenv()</em> but as a <em>Map</em>.</p></blockquote><p>获取环境变量</p><li><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">inheritIO</span><span class="o">()</span>
</pre></table></code></div></div><blockquote><p>If we want to specify that the source and destination for our subprocess standard I/O should be the same as that of the current Java process, we can use the <em>inheritIO</em> method.</p></blockquote><p>子进程使用当前 Java 进程相同的 IO</p><li><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">redirectInput</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span><span class="o">),</span> <span class="n">redirectOutput</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span><span class="o">),</span> <span class="n">redirectError</span><span class="o">(</span><span class="nc">File</span> <span class="n">file</span><span class="o">)</span>
</pre></table></code></div></div><blockquote><p>When we want to redirect the process builder’s standard input, output and error destination to a file, we have these three similar redirect methods at our disposal.</p></blockquote><p>重定向输入、输出、错误的重定向</p><li><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">start</span><span class="o">()</span>
</pre></table></code></div></div><blockquote><p>Last but not least, to start a new process with what we’ve configured, we simply call <em>start()</em>.</p></blockquote><p>启动进程</p></ul><p>一个例子：</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">givenProcessBuilder_whenModifyWorkingDir_thenSuccess</span><span class="o">()</span> 
  <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">,</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
    <span class="nc">ProcessBuilder</span> <span class="n">processBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ProcessBuilder</span><span class="o">(</span><span class="s">"/bin/sh"</span><span class="o">,</span> <span class="s">"-c"</span><span class="o">,</span> <span class="s">"ls"</span><span class="o">);</span>

    <span class="n">processBuilder</span><span class="o">.</span><span class="na">directory</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"src"</span><span class="o">));</span>
    <span class="nc">Process</span> <span class="n">process</span> <span class="o">=</span> <span class="n">processBuilder</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">readOutput</span><span class="o">(</span><span class="n">process</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">());</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="s">"Results should not be empty"</span><span class="o">,</span> <span class="n">results</span><span class="o">,</span> <span class="n">is</span><span class="o">(</span><span class="n">not</span><span class="o">(</span><span class="n">empty</span><span class="o">())));</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="s">"Results should contain directory listing: "</span><span class="o">,</span> <span class="n">results</span><span class="o">,</span> <span class="n">contains</span><span class="o">(</span><span class="s">"main"</span><span class="o">,</span> <span class="s">"test"</span><span class="o">));</span>

    <span class="kt">int</span> <span class="n">exitCode</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="na">waitFor</span><span class="o">();</span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="s">"No errors should be detected"</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">exitCode</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/language/'>language</a>, <a href='/categories/java/'>java</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=serialVersionUID+%E5%92%8C+Runtime+-+Chai+Yan&url=%2Flanguage%2Fjava%2Fposts%2Fserialversionuid_runtime_process%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=serialVersionUID+%E5%92%8C+Runtime+-+Chai+Yan&u=%2Flanguage%2Fjava%2Fposts%2Fserialversionuid_runtime_process%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Flanguage%2Fjava%2Fposts%2Fserialversionuid_runtime_process%2F&text=serialVersionUID+%E5%92%8C+Runtime+-+Chai+Yan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/tool/posts/mac_setup/">Mac 重装</a><li><a href="/linux/posts/locale/">Linux Locale</a><li><a href="/linux/posts/manjaro_i3/">Manjaro i3</a><li><a href="/board/bbb/posts/openwrt/">BeagleBone Black 安装 OpenWrt</a><li><a href="/collection/articles/posts/code/">编程</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/latex/">latex</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/vim/">vim</a> <a class="post-tag" href="/tags/java8/">java8</a> <a class="post-tag" href="/tags/mac/">mac</a> <a class="post-tag" href="/tags/manjaro/">manjaro</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a> <a class="post-tag" href="/tags/json/">json</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/language/java/posts/mybatis_generator_lombok_plugin/"><div class="card-body"> <em class="small" data-ts="1559836800" data-df="ll" > Jun 7, 2019 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>mybatis-generator-lombok-plugin</h3><div class="text-muted small"><p> mybatis-generator-lombok-plugin 功能 整合lombok插件实现@Data自动注解，取消getter、setter方法的自动生成。 自定义注释生成器，抓取数据库表的列注释作为实体类注释。 用法 git clone到IDEA，根据自己需要进行更改，再添加到本地maven仓库。 git clone到本地，通过maven clean in...</p></div></div></a></div><div class="card"> <a href="/language/java/posts/Java8_1/"><div class="card-body"> <em class="small" data-ts="1560614400" data-df="ll" > Jun 16, 2019 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java8（一）：Lambda表达式-函数式接口</h3><div class="text-muted small"><p> Java supports anonymous functions, named Lambda Expressions, starting with JDK 8. Lambda Expressions, a new language feature, has been introduced in this release. They enable you to treat f...</p></div></div></a></div><div class="card"> <a href="/language/java/posts/Java8_2/"><div class="card-body"> <em class="small" data-ts="1561219200" data-df="ll" > Jun 23, 2019 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java8（二）：Stream</h3><div class="text-muted small"><p> Stream是什么 Stream 不是集合元素，它不是数据结构并不保存数据，它是有关算法和计算的，它更像一个高级版本的 Iterator。原始版本的 Iterator，用户只能显式地一个一个遍历元素并对其执行某些操作；高级版本的 Stream，用户只要给出需要对其包含的元素执行什么操作，比如 “过滤掉长度大于 10 的字符串”、“获取每个字符串的首字母”等，Stream 会隐式地在内...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/board/pi/posts/enterprise_wpa2/" class="btn btn-outline-primary" prompt="Older"><p>树莓派连接 Wi-Fi</p></a> <a href="/tool/posts/gist/" class="btn btn-outline-primary" prompt="Newer"><p>gist</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/chaiyao0216">Chai Yan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/latex/">latex</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/vim/">vim</a> <a class="post-tag" href="/tags/java8/">java8</a> <a class="post-tag" href="/tags/mac/">mac</a> <a class="post-tag" href="/tags/manjaro/">manjaro</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/jekyll/">jekyll</a> <a class="post-tag" href="/tags/json/">json</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
